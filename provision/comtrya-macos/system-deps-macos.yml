---
labels:
  - system-deps
  - macos
contexts:
  - os.family == "Darwin"
actions:
  # Install Homebrew
  - action: command.run
    command: /bin/bash
    args:
      - -c
      - '/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"'
  # Add Homebrew to PATH for current session
  - action: command.run
    command: /bin/bash
    args:
      - -c
      - 'echo "eval \"$(/opt/homebrew/bin/brew shellenv)\"" >> {{ user.home_dir }}/.zprofile'
  - action: command.run
    command: /bin/bash
    args:
      - -c
      - 'eval "$(/opt/homebrew/bin/brew shellenv)"'
  # Install essential packages via Homebrew
  - action: command.run
    command: /opt/homebrew/bin/brew
    args:
      - install
      - git
      - curl
      - wget
      - jq
      - tmux
      - neovim
      - fish
      - starship
      - zoxide
      - fzf
      - ripgrep
      - fd
      - bat
      - exa
      - htop
      - tree
      - unzip
      - gpg
  # Install Homebrew Cask applications
  - action: command.run
    command: /opt/homebrew/bin/brew
    args:
      - install
      - --cask
      - visual-studio-code
      - iterm2
      - docker