---
labels:
  - system-deps
  - openssl
depends:
  - system-deps
actions:
  - action: command.run
    command: mkdir
    args:
      - -p
      - '{{ user.home_dir }}/.local/src'
  - action: command.run
    command: curl
    args:
      - -s
      - -S
      - -f
      - -L
      - -o
      - '{{ user.home_dir }}/.local/src/openssl-1.1.1m.tar.gz'
      - https://www.openssl.org/source/openssl-1.1.1m.tar.gz
  - action: command.run
    dir: '{{ user.home_dir }}/.local/src'
    command: tar
    args:
      - -x
      - -z
      - -f
      - '{{ user.home_dir }}/.local/src/openssl-1.1.1m.tar.gz'
  - action: command.run
    dir: '{{ user.home_dir }}/.local/src/openssl-1.1.1m'
    command: ./config
    args:
      - --prefix='{{ user.home_dir }}/.local/lib/ssl'
      - --openssldir='{{ user.home_dir }}/.local/lib/ssl'
      - shared
      - zlib
  - action: command.run
    dir: '{{ user.home_dir }}/.local/src/openssl-1.1.1m'
    command: make
  - action: command.run
    dir: '{{ user.home_dir }}/.local/src/openssl-1.1.1m'
    command: make
    args:
      - install
